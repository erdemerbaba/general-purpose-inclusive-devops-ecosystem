- name: Deploy Jenkins
  kubernetes.core.k8s:
    state: present
    definition:
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: jenkins
        namespace: default
      spec:
        replicas: 1
        selector:
          matchLabels:
            app: jenkins
        template:
          metadata:
            labels:
              app: jenkins
          spec:
            containers:
              - name: jenkins
                image: jenkins/jenkins:lts
                ports:
                  - containerPort: 8443
                  - containerPort: 50000
                volumeMounts:
                  - name: jenkins-home
                    mountPath: /var/jenkins_home
            volumes:
              - name: jenkins-home
                hostPath:
                  path: /var/jenkins_home
